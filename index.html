<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=1.0">
    <meta name="description" content="ANEKAMARKET - Platform jual beli online terpercaya untuk semua kebutuhan Anda. Dekorasi, handmade, dan souvenir berkualitas.">
    <meta name="keywords" content="jual beli online, situbondo, dekorasi, handmade, souvenir">
    <meta name="author" content="ANEKAMARKET">
    <meta property="og:title" content="ANEKAMARKET | Platform Jual Beli Online Terpercaya">
    <meta property="og:description" content="Semua Bisa Jualan & Semua Bisa Pesan - Platform lengkap untuk kebutuhan jual beli online Anda">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://s.id/anekamarket">
    <meta property="og:image" content="https://raw.githubusercontent.com/LKS-88/anekamarket/refs/heads/main/Logo-Anekamarketku.png">
    <title>ANEKAMARKET | Platform Jual Beli Online Terpercaya</title>
    
    <link rel="stylesheet" href="style.css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="https://raw.githubusercontent.com/LKS-88/anekamarket/refs/heads/main/Logo-Anekamarketku.png" type="image/png">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.js"></script>
    
    <style>
        /* CSS yang sudah ada tetap dipertahankan */
        .search-modal.show { display: flex; }
        .search-modal-content { width: 90%; max-width: 600px; background: #fff; border-radius: 8px; padding: 20px; position: relative; }
        .search-modal-input { width: 100%; padding: 12px; font-size: 1rem; border: 1px solid #ccc; border-radius: 5px; margin-bottom: 15px; }
        .search-results { max-height: 400px; overflow-y: auto; }
        .search-result-item { display: flex; align-items: center; padding: 10px; border-bottom: 1px solid #eee; text-decoration: none; color: #333; transition: background-color 0.3s; }
        .search-result-item:hover { background-color: #f5f5f5; }
        .search-result-image { width: 60px; height: 60px; object-fit: cover; border-radius: 5px; margin-right: 15px; }
        .search-result-info h4 { margin: 0 0 5px 0; font-size: 1rem; font-weight: 600; }
        .search-result-info p { margin: 0; font-size: 0.85rem; color: #666; }
        .search-results-placeholder { text-align: center; color: #888; padding: 20px; }
        
        .offer-notification { position: fixed; bottom: 20px; right: 20px; background-color: #ffffff; color: #333; padding: 20px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); width: 320px; z-index: 1001; transform: translateY(200%); opacity: 0; transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out; font-family: 'Poppins', sans-serif; }
        .offer-notification.show { transform: translateY(0); opacity: 1; }
        .offer-notification .notification-content { display: none; }
        .offer-notification .notification-content.active { display: block; }
        .offer-notification h4 { margin: 0 0 10px 0; font-weight: 600; font-size: 1rem; line-height: 1.4; }
        .offer-notification .notification-buttons { display: flex; gap: 10px; margin-top: 15px; }
        .offer-notification .notification-btn { flex: 1; padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; font-weight: 500; transition: background-color 0.3s, color 0.3s; }
        .offer-notification .btn-yes { background-color: #007bff; color: white; }
        .offer-notification .btn-yes:hover { background-color: #0056b3; }
        .offer-notification .btn-no { background-color: #f1f1f1; color: #333; border: 1px solid #ddd; }
        .offer-notification .btn-no:hover { background-color: #e0e0e0; }
        .offer-notification .close-notification { position: absolute; top: 10px; right: 15px; font-size: 20px; color: #888; cursor: pointer; transition: color 0.3s; }
        .offer-notification .close-notification:hover { color: #333; }
        
        .btn-visit { display: flex; align-items: center; justify-content: center; background-color: #28a745; color: white; padding: 8px 12px; border-radius: 5px; text-decoration: none; font-weight: 500; font-size: 0.85rem; transition: background-color 0.3s; flex: 1; text-align: center; }
        .btn-visit:hover { background-color: #218838; }
        .btn-visit i { margin-right: 8px; }
        .gallery-actions { display: flex; gap: 10px; flex-wrap: wrap; }
        .gallery-actions .btn-detail, .gallery-actions .btn-order, .gallery-actions .btn-preorder-toggle, .gallery-actions .btn-visit { flex-grow: 1; min-width: 120px; }

        /* --- [PERBAIKAN TOTAL] CSS UNTUK PEMBELIAN MULTI-ITEM --- */
        .price-variations-container {
            border: 1px solid #eee;
            border-radius: 8px;
            margin-top: 15px;
            overflow: hidden;
        }
        .price-variation-item {
            display: grid;
            grid-template-columns: 1fr auto auto;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #eee;
            gap: 10px;
        }
        .price-variation-item:last-child {
            border-bottom: none;
        }
        .price-variation-info {
            display: flex;
            flex-direction: column;
        }
        .price-variation-name {
            font-weight: 600;
            color: #333;
        }
        .price-variation-value {
            font-size: 0.9rem;
            color: #007bff;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
        }
        .quantity-btn {
            background-color: #007bff;
            color: white;
            border: none;
            width: 28px;
            height: 28px;
            font-size: 1.2rem;
            line-height: 28px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 50%;
            transition: background-color 0.2s, transform 0.1s;
        }
        .quantity-btn:hover { background-color: #0056b3; }
        .quantity-btn:active { transform: scale(0.95); }
        .quantity-input {
            width: 45px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 0 5px;
            height: 28px;
            font-size: 1rem;
            font-weight: 500;
            -moz-appearance: textfield;
        }
        .quantity-input::-webkit-outer-spin-button,
        .quantity-input::-webkit-inner-spin-button {
            -webkit-appearance: none; margin: 0;
        }
        .unit-select {
            padding: 5px 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fff;
            font-family: 'Poppins', sans-serif;
        }

        .total-price {
            margin-top: 15px;
            padding: 12px;
            background: linear-gradient(135deg, #e0f7fa, #b2ebf2);
            border-radius: 8px;
            text-align: center;
            border: 1px solid #4dd0e1;
        }
        .total-price-label {
            display: block;
            font-size: 0.9rem;
            color: #00796b;
            font-weight: 500;
        }
        .total-price-value {
            font-size: 1.6rem;
            font-weight: 700;
            color: #004d40;
        }

        /* --- [FITUR TAMBAHAN] TOMBOL PEMBAYARAN MENGAMBANG --- */
        .payment-fab {
            position: fixed;
            bottom: 90px; /* Diberi jarak dari notifikasi di pojok kanan bawah */
            right: 20px;
            width: 60px;
            height: 60px;
            background-color: #007bff; /* Warna biru primer yang konsisten */
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
            z-index: 1000;
            text-decoration: none;
            transition: background-color 0.3s, transform 0.2s ease-in-out;
        }
        .payment-fab:hover {
            background-color: #0056b3;
            transform: scale(1.1);
        }
        /* Animasi denyut/gelombang sinyal */
        .payment-fab::before {
            content: '';
            position: absolute;
            z-index: -1;
            left: 50%;
            top: 50%;
            transform: translateX(-50%) translateY(-50%);
            display: block;
            width: 100%;
            height: 100%;
            background-color: #007bff;
            border-radius: 50%;
            animation: pulse-animation 2.5s infinite;
        }
        @keyframes pulse-animation {
            0% {
                transform: translateX(-50%) translateY(-50%) scale(0.9);
                opacity: 0.7;
            }
            100% {
                transform: translateX(-50%) translateY(-50%) scale(2.5);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <audio id="bgMusic" loop autoplay>
        <source src="https://raw.githubusercontent.com/Musikwebsite.mp3" type="audio/mpeg">
    </audio>
    
    <div class="particles" id="particles"></div>
    
    <header id="home">
        <div class="header-overlay"></div>
        <div class="header-content">
            <div class="logo">
                <img src="https://raw.githubusercontent.com/LKS-88/anekamarket/refs/heads/main/Logo-Anekamarketku.png" alt="ANEKAMARKET Logo">
                <span>ANEKAMARKET</span>
            </div>
            <p class="tagline">Semua Bisa Jualan & Semua Bisa Pesan</p>
            
            <div class="header-search">
                <input type="text" id="headerSearchInput" placeholder="Cari produk, UMKM, kode...">
                <button id="headerSearchBtn"><i class="fas fa-search"></i></button>
            </div>
            
            <div class="header-buttons">
                <a href="#gallery" class="btn btn-primary">
                    <i class="fas fa-images"></i> Lihat Karya & Jualan Kami
                </a>
                <a href="#contact" class="btn btn-outline">
                    <i class="fas fa-envelope"></i> Hubungi Kami
                </a>
            </div>
            <a href="#services" class="scroll-down">
                <i class="fas fa-chevron-down"></i>
            </a>
        </div>
    </header>
    
    <nav id="navbar">
        <div class="nav-container">
            <a href="#" class="nav-logo">
                <img src="https://raw.githubusercontent.com/LKS-88/anekamarket/refs/heads/main/Logo-Anekamarketku.png" alt="ANEKAMARKET Logo">
                <span>ANEKAMARKET</span>
            </a>
            
            <div class="nav-search" id="navSearch">
                <input type="text" id="navSearchInput" placeholder="Cari produk atau layanan...">
                <button id="navSearchBtn"><i class="fas fa-search"></i></button>
            </div>
            
            <button class="search-toggle" id="searchToggle">
                <i class="fas fa-search"></i>
            </button>
            
            <button class="mobile-menu-toggle" id="mobileMenuToggle">
                <i class="fas fa-bars"></i>
            </button>
            
            <div class="nav-links" id="navLinks">
                <a href="#home">Beranda</a>
                <a href="#services">Layanan</a>
                <a href="#gallery">Galeri</a>
                <a href="#contact">Kontak</a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <section class="services" id="services">
            <h2 class="section-title">Layanan Kami</h2>
            <div class="services-grid">
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <h3 class="service-title">Jasa Sewa</h3>
                    <p>Pilihan sewa fleksibel untuk dekorasi, peralatan, dan berbagai kebutuhan acara Anda.</p>
                </div>
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-bullhorn"></i>
                    </div>
                    <h3 class="service-title">Solusi Promosi</h3>
                    <p>Material pemasaran kreatif dan strategi untuk meningkatkan visibilitas merek produk Anda.</p>
                </div>
            </div>
        </section>
        
        <section class="gallery" id="gallery">
            <h2 class="section-title">Galeri Kami</h2>
            <div class="gallery-intro">
                <p>Jelajahi koleksi karya dan layanan premium kami. Klik "Detail" untuk melihat lebih banyak gambar dan informasi.</p>
                
                <div class="product-categories">
                    <button class="product-category-btn active" data-category="all">Semua Kategori</button>
                    <button class="product-category-btn" data-category="food">Makanan & Minuman</button>
                    <button class="product-category-btn" data-category="snack">Kue & Cemilan</button>
                    <button class="product-category-btn" data-category="construction">Alat Konstruksi</button>
                    <button class="product-category-btn" data-category="office">Alat Kantor</button>
                    <button class="product-category-btn" data-category="household">Alat Rumah Tangga</button>
                    <button class="product-category-btn" data-category="software">Software Aplikasi</button>
                    <button class="product-category-btn" data-category="electronics">Elektronik</button>
                    <button class="product-category-btn" data-category="fishery">Perikanan</button>
                    <button class="product-category-btn" data-category="livestock">Peternakan</button>
                    <button class="product-category-btn" data-category="agriculture">Pertanian</button>
                </div>
                
                <div class="category-tabs">
                    <button class="category-btn active" data-type="all">Semua</button>
                    <button class="category-btn" data-type="rental">Sewa</button>
                    <button class="category-btn" data-type="promo">Promosi</button>
                </div>
            </div>
            
            <div class="gallery-grid" id="gallery-grid"></div>   
        </section>

        <section class="contact" id="contact">
            <h2 class="section-title">Hubungi Kami</h2>
            <div class="contact-container">
                <div class="contact-info">
                    <h3>Informasi Kontak</h3>
                    <div class="contact-detail">
                        <i class="fas fa-map-marker-alt contact-icon"></i>
                        <div class="contact-text">
                            <h4>Alamat</h4>
                            <p>Jl. PB Sudirman, Desa Wringin Anom<br>Kec. Panarukan, Kab. Situbondo (68351)<br>Provinsi Jawa Timur</p>
                        </div>
                    </div>
                    <div class="contact-detail">
                        <i class="fas fa-phone-alt contact-icon"></i>
                        <div class="contact-text">
                            <h4>Telepon</h4>
                            <p>+6285647709114</p>
                        </div>
                    </div>
                    <div class="contact-detail">
                        <i class="fas fa-envelope contact-icon"></i>
                        <div class="contact-text">
                            <h4>Email</h4>
                            <p>admin@anekamarket.my.id</p>
                        </div>
                    </div>
                    <div class="contact-detail">
                        <i class="fas fa-clock contact-icon"></i>
                        <div class="contact-text">
                            <h4>Jam Operasional Admin</h4>
                            <p>Senin - Jumat: 09.00 - 16.00<br>Sabtu & Minggu: 07.00 - 19.00</p>
                        </div>
                    </div>
                </div>
                <div class="contact-form">
                    <h3>Kirim Pesan</h3>
                    <div id="formStatus" class="form-status" style="display: none;"></div>
                    <form id="contactForm" action="https://formsubmit.co/admin@anekamarket.my.id" method="POST">
                        <input type="hidden" name="_captcha" value="false">
                        <input type="hidden" name="_next" value="https://yourwebsite.com/thank-you.html">
                        <input type="hidden" name="_template" value="table">
                        <div class="form-group">
                            <label for="name">Nama Anda</label>
                            <input type="text" id="name" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Alamat Email</label>
                            <input type="email" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Nomor Telepon</label>
                            <input type="tel" id="phone" name="phone" required>
                        </div>
                        <div class="form-group">
                            <label for="subject">Subjek</label>
                            <select id="subject" name="subject" required>
                                <option value="" disabled selected>Pilih subjek</option>
                                <option value="general">Pertanyaan Umum</option>
                                <option value="order">Pemesanan Produk</option>
                                <option value="rental">Pertanyaan Sewa</option>
                                <option value="promo">Layanan Promosi</option>
                                <option value="other">Lainnya</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="message">Pesan</label>
                            <textarea id="message" name="message" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary" id="submitBtn">
                            <i class="fas fa-paper-plane"></i> Kirim Pesan
                        </button>
                    </form>
                </div>
            </div>
        </section>
    </div>
    
    <div class="contact-bar">
        <a href="https://wa.me/6285647709114" class="contact-btn whatsapp" target="_blank" aria-label="Hubungi via WhatsApp">
            <i class="fab fa-whatsapp"></i>
        </a>
        <a href="tel:+6285647709114" class="contact-btn phone" aria-label="Telepon Kami">
            <i class="fas fa-phone"></i>
        </a>
        <button class="contact-btn order" id="quick-order" aria-label="Pesan Cepat">
            <i class="fas fa-shopping-cart"></i>
        </button>
    </div>

    <a href="https://www.anekamarket.my.id/aplikasipembayaran" class="payment-fab" target="_blank" aria-label="Aplikasi Pembayaran Kasir">
        <i class="fas fa-cash-register"></i>
    </a>
    
    <footer>
        <div class="footer-container">
            <div class="footer-col footer-about">
                <div class="footer-logo">
                    <img src="https://raw.githubusercontent.com/LKS-88/anekamarket/refs/heads/main/Logo-Anekamarketku.png" alt="ANEKAMARKET Logo">
                    <span>ANEKAMARKET</span>
                </div>
                <p>Menyediakan pelayanan publikasi dan promosi produk UMKM, jasa sewa dan pembuatan aplikasi usaha sejak tahun 2025. Komitmen kami adalah memberikan pengalaman berbelanja online yang menyenangkan dan memuaskan.</p>
            </div>
            
            <div class="footer-col">
                <h3>Tautan Cepat</h3>
                <ul class="footer-links">
                    <li><a href="#home">Beranda</a></li>
                    <li><a href="#services">Layanan</a></li>
                    <li><a href="#gallery">Galeri</a></li>
                    <li><a href="#contact">Kontak</a></li>
                </ul>
            </div>
            
            <div class="footer-col">
                <h3>Newsletter</h3>
                <p>Berlangganan newsletter kami untuk mendapatkan update produk terbaru dan penawaran spesial.</p>
                <form class="newsletter-form">
                    <input type="email" placeholder="Alamat email Anda" required>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-envelope"></i> Berlangganan
                    </button>
                </form>
            </div>
        </div>
        
        <div class="copyright">
            &copy; 2025 ANEKAMARKET. Semua hak dilindungi. | <a href="#">Kebijakan Privasi</a> | <a href="#">Syarat & Ketentuan</a>
        </div>
    </footer>
    
    <div class="modal" id="orderModal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Pesan Cepat</h2>
            <form id="quickOrderForm" action="https://formsubmit.co/admin@anekamarket.my.id" method="POST">
                <input type="hidden" name="_subject" value="Pesan Cepat dari Website">
                <input type="hidden" name="_captcha" value="false">
                <div class="form-group">
                    <label for="quick-name">Nama Anda</label>
                    <input type="text" id="quick-name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="quick-phone">Nomor Telepon</label>
                    <input type="tel" id="quick-phone" name="phone" required>
                </div>
                <div class="form-group">
                    <label for="quick-item">Produk yang Diminati</label>
                    <input type="text" id="quick-item" name="product" required>
                </div>
                <div class="form-group">
                    <label for="quick-message">Detail Tambahan</label>
                    <textarea id="quick-message" name="message"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-paper-plane"></i> Kirim Permintaan
                </button>
            </form>
        </div>
    </div>
    
    <div class="search-modal" id="searchModal">
        <div class="search-modal-content">
            <span class="close-search-modal">&times;</span>
            <input type="text" class="search-modal-input" placeholder="Cari produk, UMKM, kode..." id="searchModalInput">
            <div class="search-results" id="searchResults">
                <p class="search-results-placeholder">Mulai ketik untuk mencari produk...</p>
            </div>
        </div>
    </div>
    
    <div class="image-modal" id="imageModal">
        <div class="image-modal-content">
            <span class="close-image-modal">&times;</span>
            <img id="zoomedImage" src="" alt="Zoomed Image">
        </div>
    </div>

    <div class="offer-notification" id="offerNotification">
        <span class="close-notification" id="closeNotification">&times;</span>
        
        <div class="notification-content active" id="notificationStep1">
            <h4>Punya bisnis atau usaha? 🚀 Ingin menjangkau lebih banyak pelanggan?</h4>
            <div class="notification-buttons">
                <button class="notification-btn btn-no" data-action="close">Tidak</button>
                <button class="notification-btn btn-yes" data-action="next">Iya, Tentu</button>
            </div>
        </div>
        
        <div class="notification-content" id="notificationStep2">
            <h4>Tertarik mendaftarkan usaha Anda di Anekamarket secara GRATIS dan tanpa komisi?</h4>
            <div class="notification-buttons">
                <button class="notification-btn btn-no" data-action="close">Lain Kali</button>
                <button class="notification-btn btn-yes" data-action="register">Iya, Saya Mau</button>
            </div>
        </div>
    </div>
    
    <audio id="buttonSound" src="https://raw.githubusercontent.com/LenteraKarya/Lentera-Karya/main/assets/audio/audiotombol.mp3"></audio>
    
    <script>
        // --- DATA PRODUK (TIDAK BERUBAH) ---
        const products = [
        { id: "AWF-2025-2575", category: "livestock", type: "promo", seller: { name: "Ardiwillis Farm", link: "https://www.anekamarket.my.id/ardiwillisfarm" }, badge: { text: "Promosi", type: "promo" }, mainImage: "https://i.imgur.com/pKLE9EY.jpeg", title: "Paket Lengkap Ternak Ayam Ardiwilis", code: "AWF-2025-2575", price: 8000, originalPrice: 10000, discount: "10%", priceVariations: [ { name: "Ecer (per ekor)", price: 8000 }, { name: "10 ekor", price: 75000 }, { name: "100 ekor", price: 700000 } ], units: ["pcs", "kg", "biji", "ekor"], defaultUnit: "ekor", details: { description: "Ardiwillis Farm menyediakan produk unggulan peternakan ayam berkualitas tinggi. Kami menyediakan telur tetas fertil dengan daya tetas tinggi, DOC (Day Old Chicken) berbagai strain unggul, ayam karkas segar, dan ayam bakar siap saji dengan bumbu khas. Semua produk dihasilkan dari peternakan yang dikelola secara profesional dengan standar kesehatan dan kebersihan tinggi. (Note: Harga tersebut bukan harga tetap, & bisa berubah)", images: [ "https://i.imgur.com/pAygjAZ.jpeg", "https://i.imgur.com/XRMPBhw.jpeg", "https://i.imgur.com/K5m75Rq.jpeg", "https://i.imgur.com/coJadaj.jpeg" ], specs: [ { label: "Kode Produk", value: "AWF-2025-2575" }, { label: "Gerai", value: "Ardiwillis Farm" }, { label: "Jenis", value: "Ayam Pedaging" }, { label: "Usia", value: "DOC (1 hari)" }, { label: "Strain", value: "Cobb 500" }, { label: "Garansi", value: "Hidup sampai diterima" }, { label: "Minimal Order", value: "10 ekor" }, { label: "Catatan", value: "Harga bisa berubah sewaktu-waktu" } ] }, contact: { whatsapp: "6285258544543", phone: "+6285258544543" } },
        { id: "NS-2025-3348", category: "food", type: "promo", seller: { name: "Niki Sae", link: "https://www.anekamarket.my.id/nikisae" }, badge: { text: "Promo Spesial", type: "promo" }, mainImage: "https://i.imgur.com/y8r14Z3.jpeg", title: "Promo Frozen Food Homemade Niki Sae", code: "NS-2025-3348", price: 12000, originalPrice: 15000, discount: "20% OFF", priceVariations: [ { name: "Pempek", price: 12000, original: 15000 }, { name: "Tahu Walik", price: 11000, original: 13750 }, { name: "Nugget Ikan/Ayam", price: 12000, original: 15000 }, { name: "Dragon Stick", price: 12000, original: 15000 }, { name: "Otak-Otak Ikan", price: 12000, original: 15000 } ], units: ["pcs", "pack", "set", "lusin"], defaultUnit: "pcs", details: { description: "<strong>PROMO SPESIAL!</strong> Niki Sae dari Dapur Yunna menghadirkan promo frozen food homemade dengan kualitas terbaik. Semua produk dibuat dengan bahan pilihan dan teknik khusus untuk menjamin cita rasa autentik. Produk kami termasuk Pempek, Tahu Walik, Otak-Otak Ikan, Nugget Ikan dan Ayam, serta Dragon Stick. Setiap produk dibuat dengan standar kebersihan tinggi dan rasa yang konsisten. Nikmati diskon spesial untuk pembelian selama periode promo!", images: [ "https://i.imgur.com/RP8HTMb.jpeg", "https://i.imgur.com/GWXfEGJ.jpeg", "https://i.imgur.com/WSB6cXr.jpeg", "https://i.imgur.com/ubU63gJ.jpeg" ], specs: [ { label: "Kode Promo", value: "NS-2025-3348" }, { label: "Nama UMKM", value: "Niki Sae Pempek dan Tahu walik" }, { label: "Pemilik", value: "Yuliana Mulyaningtyas" }, { label: "Alamat", value: "Perum Graha Sultan Raya 1 blok G. 61, Panji" }, { label: "Kontak", value: "085731247566" }, { label: "Media Sosial", value: "Belum tersedia" }, { label: "Daftar Promo", value: "• Pempek <s>Rp15.000</s> <strong>Rp12.000</strong> (20% OFF)<br>• Tahu Walik <s>Rp13.750</s> <strong>Rp11.000</strong> (20% OFF)<br>• Nugget Ikan/Ayam <s>Rp15.000</s> <strong>Rp12.000</strong> (20% OFF)<br>• Dragon Stick <s>Rp15.000</s> <strong>Rp12.000</strong> (20% OFF)<br>• Otak-Otak Ikan <s>Rp15.000</s> <strong>Rp12.000</strong> (20% OFF)" }, { label: "Periode Promo", value: "Periode Promo sewaktu-waktu tidak berlaku" }, { label: "Catatan", value: "• Harga normal berlaku setelah periode promo berakhir<br>• Minimal pembelian 5 pcs per item<br>• Free ongkir untuk pembelian di atas Rp100.000 (area tertentu)" } ] }, contact: { whatsapp: "6285731247566", phone: "+6285731247566" } },
        { id: "PRD-2025-2688", category: "fishery", type: "promo", seller: { name: "PRADIPA", link: "https://www.anekamarket.my.id/pradipa" }, badge: { text: "Promosi", type: "promo" }, mainImage: "https://i.imgur.com/ru1FKXW.jpeg", title: "Produk Hasil Laut Segar Pradipa", code: "PRD-2025-2688", price: 30000, originalPrice: null, discount: null, priceVariations: [ { name: "Ikan Bogek/Mendut", price: 35000 }, { name: "Ikan Mangla/Swangi", price: 30000 }, { name: "Ikan Sebelah/Sulfis", price: 35000 } ], units: ["kg", "ekor", "pack"], defaultUnit: "kg", details: { description: "PRADIPA menghadirkan hasil laut segar langsung dari perairan Panarukan. Kami menyediakan berbagai jenis ikan berkualitas tinggi yang ditangkap dengan metode ramah lingkungan. Setiap produk kami melalui proses seleksi ketat untuk memastikan kesegaran dan kualitas terbaik untuk pelanggan. Dengan pengalaman bertahun-tahun di bidang hasil laut, kami berkomitmen memberikan produk terbaik dengan harga kompetitif.", images: [ "https://i.imgur.com/n2AkesD.jpeg", "https://i.imgur.com/tupfVCl.jpeg", "https://i.imgur.com/VhfoAsv.png" ], specs: [ { label: "Kode Produk", value: "PRD-2025-2688" }, { label: "Gerai", value: "PRADIPA" }, { label: "Pemilik", value: "Fajar Nur Cholis" }, { label: "Alamat", value: "Tanah Anyar RT 3 RW 02 Desa Kilensari, Panarukan" }, { label: "Kontak", value: "082334393922 | quenie89@gmail.com" }, { label: "Produk Unggulan", value: "Ikan Bogek/Mendut (Rp35.000/kg), Ikan Mangla/Swangi (Rp30.000/kg), Ikan Sebelah/Sulfis (Rp35.000/kg)" }, { label: "Catatan", value: "Harga bisa berubah sewaktu-waktu" } ] }, contact: { whatsapp: "6282334393922", phone: "+6282334393922" } },
        { id: "MCU-2025-2830", category: "snack", type: "promo", seller: { name: "Mochi UMA", link: "https://www.anekamarket.my.id/mochiuma" }, badge: { text: "Promo Spesial", type: "promo" }, mainImage: "https://i.imgur.com/TPSWsZw.jpeg", title: "Promo Aneka Kue Lezat Mochi Uma", code: "MCU-2025-2830", price: 10000, originalPrice: null, discount: null, priceVariations: [ { name: "Pancake Durian", price: 10000 }, { name: "Mochi (3pcs)", price: 10000 }, { name: "Cireng Ayam Suwir", price: 10000 }, { name: "Corndog Coklat (isi 3)", price: 10000 } ], units: ["pcs", "pack", "set", "lusin"], defaultUnit: "pcs", details: { description: "<strong>PROMO SPESIAL!</strong> Mochi UMA menghadirkan paket promo aneka kue lezat dengan harga spesial. Nikmati berbagai pilihan kue premium dengan diskon menarik untuk waktu terbatas. Setiap produk dibuat dengan bahan pilihan dan teknik khusus untuk menjamin cita rasa autentik. Jangan lewatkan kesempatan ini untuk menikmati kue berkualitas dengan harga terjangkau!", images: [ "https://i.imgur.com/dlK9kfP.jpeg", "https://i.imgur.com/JsXOHCO.jpeg", "https://i.imgur.com/kJDDUy4.jpeg" ], specs: [ { label: "Kode Promo", value: "MCU-2025-2830" }, { label: "Nama UMKM", value: "Mochi UMA" }, { label: "Pemilik", value: "ULink" }, { label: "Alamat", value: "Jl. Wijaya Kusuma Samping Bidan Ika" }, { label: "Kontak", value: "089679013099 | nurilaneeh@gmail.com" }, { label: "Media Sosial", value: "TikTok @mochi.uma3" }, { label: "Daftar Promo", value: "• Pancake Durian hanya Rp10.000<br>• Mochi 3pcs Rp10.000<br>• Cireng Ayam Suwir Rp10.000<br>• Corndog Coklat isi 3 Rp10.000" }, { label: "Periode Promo", value: "Sampai 31 Agustus 2025" }, { label: "Catatan", value: "Harga bisa berubah sewaktu-waktu" } ] }, contact: { whatsapp: "6289679013099", phone: "+6289679013099" } },
        { id: "UDJ-2025-3038", category: "agriculture", type: "all", seller: { name: "UD Jaya Makmur", link: "https://www.anekamarket.my.id/jayamakmur" }, badge: { text: "Grosir", type: "rental" }, mainImage: "https://i.imgur.com/fjnwYfW.jpeg", title: "Garam Krosok Geo Membran Premium", code: "UDJ-2025-3038", price: 2500, originalPrice: null, discount: null, priceVariations: [ { name: "Per Kilo", price: 2500 }, { name: "3.5 Ton (Minimal Order)", price: 8750000 } ], units: ["kg", "ton"], defaultUnit: "kg", details: { description: "<strong>UD Jaya Makmur</strong> menghadirkan garam krosok geo membran premium berkualitas tinggi dari Panarukan. Garam kami diproduksi dengan metode geo membran yang menghasilkan garam dengan kadar NaCl tinggi (minimal 95%) dan rendah pengotor. Kami menyediakan garam dengan kualitas konsumsi dan industri, dikemas secara higienis dan siap dikirim ke seluruh Indonesia. Minimal pembelian 3.500 kg dengan layanan pengantaran langsung ke lokasi Anda. Garam kami cocok untuk berbagai kebutuhan mulai dari industri, rumah tangga, hingga pengolahan makanan. Anda juga bisa order ke Nomor Whatsapp : 082244014323", images: [ "https://i.imgur.com/WFbAET3.jpeg", "https://i.imgur.com/EwIAvxE.jpeg", "https://i.imgur.com/5w9ueN7.jpeg" ], specs: [ { label: "Kode Produk", value: "UDJ-2025-3038" }, { label: "Nama UMKM", value: "UD Jaya Makmur" }, { label: "Pemilik", value: "Zaini" }, { label: "Alamat", value: "Kp. Sabrang RT 001 RW 001 Desa Wringin Anom, Panarukan" }, { label: "Kontak", value: "087816295963 | jayamakmurpanarukan@gmail.com" }, { label: "Jenis Produk", value: "Garam Krosok Geo Membran" }, { label: "Harga", value: "Rp 2.500/kg (minimal 3.500 kg)" }, { label: "Pengiriman", value: "Gratis ongkir untuk area tertentu (minimal 3.5 ton)" }, { label: "Catatan", value: "Harga bisa berubah sewaktu-waktu" } ] }, contact: { whatsapp: "6287816295963", phone: "+6287816295963" } },
        { id: "BNJ-2025-3184", category: "food", type: "all", seller: { name: "Bu Nju", link: "https://www.anekamarket.my.id/bunju" }, badge: { text: "Produk Lokal", type: "promo" }, mainImage: "https://i.imgur.com/Ra4CZgd.jpeg", title: "Ikan Kering & Terasi Puger Premium", code: "BNJ-2025-3184", price: 4000, originalPrice: null, discount: null, priceVariations: [ { name: "Terasi Puger 1kg", price: 80000 }, { name: "Terasi Puger 1ons", price: 8000 }, { name: "Terasi Puger ½ons", price: 4000 }, { name: "Ikan Kering (berbumbu)", price: 70000 }, { name: "Ikan Kering (polos)", price: 60000 } ], units: ["pcs", "kg", "ons", "pack"], defaultUnit: "pcs", details: { description: "<strong>Bu Nju</strong> menghadirkan produk ikan kering dan terasi Puger berkualitas premium dari Panarukan. Terasi kami diproduksi secara tradisional dengan kualitas terbaik, memiliki aroma khas dan rasa gurih autentik. Ikan kering kami diproses secara higienis dengan dua varian: siap goreng (sudah berbumbu) dan polos (tanpa bumbu). Semua produk dibuat dengan bahan pilihan dan pengolahan yang menjaga cita rasa asli. Cocok untuk berbagai masakan rumahan hingga usaha kuliner.", images: [ "https://i.imgur.com/CV57qDP.jpeg", "https://i.imgur.com/ImPrZJw.jpeg", "https://i.imgur.com/eFnhNYu.jpeg" ], specs: [ { label: "Kode Produk", value: "BNJ-2025-3184" }, { label: "Nama UMKM", value: "Bu Nju" }, { label: "Pemilik", value: "Riqi" }, { label: "Alamat", value: "Karangsari, Desa Kilensari, Kecamatan Panarukan" }, { label: "Kontak", value: "082327600708 | vaiper.blood22@gmail.com" }, { label: "Daftar Harga", value: "• Terasi Puger 1kg: Rp80.000<br>• Terasi Puger 1ons: Rp8.000<br>• Terasi Puger ½ons: Rp4.000<br>• Ikan kering berbumbu: Rp70.000/kg<br>• Ikan kering polos: Rp60.000/kg" }, { label: "Media Sosial", value: "TikTok @seesaretadek" }, { label: "Catatan", value: "Harga bisa berubah sewaktu-waktu" } ] }, contact: { whatsapp: "6282327600708", phone: "+6282327600708" } },
        { id: "LDW-2025-8001", category: "software", type: "promo", seller: { name: "Lentera Karya Situbondo", link: "https://www.anekamarket.my.id/lenterakaryasitubondo" }, badge: { text: "Super Deal", type: "promo" }, mainImage: "https://i.imgur.com/VumvfHv.png", title: "Paket Lengkap Aplikasi Web HTML", code: "LDW-2025-8001", price: 599000, originalPrice: 899000, discount: "33% OFF", priceVariations: [ { name: "Paket Komplit (7 Aplikasi)", price: 599000, original: 899000 }, { name: "Aplikasi Kasir Web", price: 350000, original: 450000 }, { name: "Sistem Pembukuan Web", price: 400000, original: 550000 } ], units: ["paket", "lisensi", "unit"], defaultUnit: "paket", details: { description: "<strong>SOLUSI APLIKASI WEB TERBAIK UNTUK BISNIS ANDA!</strong> Paket lengkap aplikasi web HTML kami dirancang khusus untuk bekerja sempurna di semua perangkat tanpa perlu instalasi. Cukup buka browser dan aplikasi siap digunakan! Setiap aplikasi memiliki anturarmuka modern yang responsif, beradaptasi otomatis dengan layar desktop, tablet, maupun smartphone. Sistem kami mencakup fitur-fitur canggih seperti penyimpanan data di perangkat pengguna, backup/restore, laporan transaksi, dan cetak struk - semuanya dalam platform web yang ringan dan cepat.", images: [ "https://i.imgur.com/GjByUuX.png", "https://i.imgur.com/rsR7RhC.png", "https://i.imgur.com/gg5AGFc.png", "https://i.imgur.com/VumvfHv.png" ], specs: [ { label: "Kode Produk", value: "LDW-2025-8001" }, { label: "Developer", value: "Lentera Karya Situbondo" }, { label: "Daftar Aplikasi", value: "• Aplikasi Kasir Web - Sistem kasir lengkap dengan cetak struk<br>• Sistem Pembukuan Web - Pencatatan keuangan profesional<br>• Aplikasi Absensi Web - Manajemen kehadiran karyawan<br>• Sistem Manajemen Restoran - Pesanan, meja, dan kitchen display<br>• Website Profesional Instan - Website bisnis siap pakai<br>• Aplikasi Tiket/Karcis - Sistem tiket elektronik<br>• Sistem Penginapan Web - Manajemen kamar dan tamu" }, { label: "Fitur Unggulan", value: "• Akses dari perangkat apapun dengan browser modern<br>• Tampilan responsif otomatis menyesuaikan layar<br>• Tanpa perlu instalasi - langsung buka file<br>• Penyimpanan data aman di perangkat pengguna<br>• Backup & restore data dengan satu klik<br>• Laporan keuangan lengkap dengan grafik<br>• Multi-user support dengan level akses berbeda<br>• Offline capable (PWA) - bisa digunakan tanpa internet" }, { label: "Kompatibilitas", value: "• Browser: Chrome, Firefox, Edge, Safari versi terbaru<br>• Sistem Operasi: Windows 10/11, macOS, Linux, Android, iOS<br>• Perangkat: Desktop, Laptop, Tablet, Smartphone<br>• Resolusi: Mendukung dari 320px hingga 4K" }, { label: "Cara Penggunaan", value: "1. Terima file HTML via email setelah pembelian<br>2. Buka file di browser favorit Anda (Chrome direkomendasikan)<br>3. Aplikasi siap digunakan segera!<br>4. Simpan sebagai PWA (Add to Home Screen) untuk pengalaman seperti aplikasi native<br>5. Untuk backup, cukup simpan file data yang dihasilkan aplikasi" } ] }, contact: { whatsapp: "6285647709114", phone: "+6285647709114" } },
        { id: "LDW-2025-8002", category: "software", type: "promo", seller: { name: "Lentera Karya Situbondo", link: "https://www.anekamarket.my.id/lenterakaryasitubondo" }, badge: { text: "Baru!", type: "new" }, mainImage: "https://i.imgur.com/i7PAJfs.png", title: "Aplikasi Kasir Web HTML", code: "LDW-2025-8002", price: 350000, originalPrice: 450000, discount: "22% OFF", priceVariations: [ { name: "Lisensi Tunggal", price: 350000, original: 450000 } ], units: ["lisensi", "pcs", "unit"], defaultUnit: "lisensi", details: { description: "<strong>APLIKASI KASIR MODERN TANPA INSTALASI!</strong> Aplikasi Kasir Web HTML dari Lentera Karya Situbondo adalah solusi sempurna untuk bisnis retail, toko, atau usaha kecil. Cukup buka file HTML di browser dan aplikasi siap digunakan! Dirancang khusus untuk bekerja optimal di semua perangkat - dari desktop PC hingga smartphone. Fitur termasuk manajemen produk, transaksi cepat, cetak struk, laporan penjualan, dan penyimpanan data langsung di perangkat Anda. Tidak perlu server mahal atau koneksi internet terus-menerus!", images: [ "https://i.imgur.com/9IuPANW.png", "https://i.imgur.com/PY8ge6k.png", "https://i.imgur.com/2Yr4njs.png", "https://i.imgur.com/i7PAJfs.png" ], specs: [ { label: "Kode Produk", value: "LDW-2025-8002" }, { label: "Developer", value: "Lentera Karya Situbondo" }, { label: "Fitur Inti", value: "• Input transaksi cepat dengan antarmuka modern<br>• Manajemen produk & kategori<br>• Pencarian produk instan dengan autocomplete<br>• Cetak struk pdf dengan header custom<br>• Laporan harian/mingguan/bulanan dengan grafik<br>• Backup & restore data dengan enkripsi<br>• Manajemen diskon dan promo produk<br>• Hitung kembalian & Stok otomatis berkurang saat transaksi" }, { label: "Keunggulan", value: "• Buka langsung di browser tanpa proses instalasi<br>• Tampilan responsif semua device (desktop, tablet, HP)<br>• Bisa digunakan offline setelah pertama kali dibuka<br>• Penyimpanan data aman di perangkat pengguna<br>• Tidak perlu server/hosting yang mahal<br>• Ringan dan cepat bahkan di spesifikasi rendah<br>• Update mudah dengan mengganti file HTML<br>• Tidak ada biaya bulanan/tahunan" }, { label: "Cara Implementasi", value: "1. Dapatkan file HTML aplikasi setelah pembelian<br>2. Buka file di browser favorit (Chrome direkomendasikan)<br>3. Mulai gunakan aplikasi kasir langsung<br>4. (Opsional) Simpan sebagai PWA untuk pengalaman seperti app native<br>5. Data otomatis tersimpan aman di perangkat<br>6. Backup rutin dengan menyimpan file data yang dihasilkan" }, { label: "Bonus Pembelian", value: "• Panduan penggunaan video step-by-step<br>• Template struk profesional yang bisa dicustom<br>• File contoh database produk siap pakai<br>• Support via WhatsApp  gratis<br>• Voucher diskon 15% untuk pembelian produk lain" } ] }, contact: { whatsapp: "6285647709114", phone: "+6285647709114" } },
        { id: "PRD-2025-0610", category: "food", type: "promo", seller: { name: "Warung Pak Untung", link: "https://anekamarket.my.id/pakuntung" }, badge: { text: "Diskon Spesial", type: "promo" }, mainImage: "https://i.imgur.com/1Mvj3cv.jpeg", title: "Menu Bakaran Spesial Warung Pak Untung", code: "PRD-2025-0610", price: 30000, originalPrice: 50000, discount: "40% OFF", priceVariations: [ { name: "Paket Hemat Komplit", price: 30000, original: 50000 }, { name: "Ikan Super (1 org) - 2 ons", price: 25000 }, { name: "Ikan Super (1 org) - 3 ons", price: 30000 }, { name: "Ikan Super (1 org) - 4 ons", price: 35000 }, { name: "Ikan Super (1 org) - 5 ons", price: 45000 }, { name: "Ikan Super (1 org) - 6 ons", price: 55000 }, { name: "Ikan Super (1 org) - 7 ons", price: 60000 }, { name: "Ikan Super (1 org) - 8 ons", price: 70000 }, { name: "Ikan Super (1 org) - 9 ons", price: 80000 }, { name: "Ikan Super (1 org) - 1 kg", price: 90000 }, { name: "Ikan Super (2 org) - 2 ons", price: 30000 }, { name: "Ikan Super (2 org) - 3 ons", price: 40000 }, { name: "Ikan Super (2 org) - 4 ons", price: 50000 }, { name: "Ikan Super (2 org) - 5 ons", price: 60000 }, { name: "Ikan Super (2 org) - 6 ons", price: 65000 }, { name: "Ikan Super (2 org) - 7 ons", price: 75000 }, { name: "Ikan Super (2 org) - 8 ons", price: 85000 }, { name: "Ikan Super (2 org) - 9 ons", price: 95000 }, { name: "Ikan Super (2 org) - 1 kg", price: 100000 } ], units: ["porsi", "kg", "ons", "ekor"], defaultUnit: "porsi", details: { description: "<strong>Diskon Spesial: Nikmati Sensasi Kuliner Laut Bakar di Warung Pak Untung!</strong><br>Cari tempat makan yang bikin penasaran? Mampir ke <strong>Warung Pak Untung</strong>! Terletak strategis di dekat destinasi Wisata Kampung Kerapu, kami menyajikan hidangan laut bakar segar dengan bumbu rahasia yang meresap sempurna hingga ke dalam daging.<br><br>🔥 <strong>PROMO SPESIAL!</strong> Jangan lewatkan paket komplit kami yang super hemat! Cukup dengan <strong>Rp 30.000</strong> saja dari harga normal Rp 50.000, Anda sudah bisa menikmati hidangan lezat yang bikin ketagihan.<br><br>Ingin yang lebih spesial? Pilih sendiri <strong>ikan super segar</strong> kami dengan berbagai ukuran sesuai selera Anda, cocok untuk dinikmati sendiri atau beramai-ramai. Setiap hidangan disajikan dengan sambal khas Pak Untung yang pedasnya nendang dan segar, dijamin akan menyempurnakan setiap suapan Anda.", images: [ "https://i.imgur.com/1Mvj3cv.jpeg", "https://i.imgur.com/54G3vZ8.jpeg", "https://i.imgur.com/jSYOe6m.jpeg", "https://i.imgur.com/YqGxIMK.jpeg", "https://i.imgur.com/2tbgQnd.jpeg", "https://i.imgur.com/aSEVqAp.jpeg", "https://i.imgur.com/v1kqfUt.jpeg", "https://i.imgur.com/8XfYID8.jpeg", "https://i.imgur.com/QjUO7gc.jpeg", "https://i.imgur.com/NgAvdi7.jpeg", "https://i.imgur.com/MOahwIU.jpeg", "https://i.imgur.com/vTbwJGv.jpeg" ], specs: [ { label: "Kode Promo", value: "PRD-2025-0610" }, { label: "Nama Gerai", value: "Warung Pak Untung" }, { label: "Pemilik", value: "Mas Eko" }, { label: "Alamat", value: "Jalan Raya Gundil, sebelah barat Wisata Kampung Kerapu (selatan jalan)" }, { label: "Kontak", value: "083826231962" }, { label: "Menu Promo", value: "• Paket Hemat Komplit <s>Rp50.000</s> <strong>Rp30.000</strong> (Diskon 40%)" }, { label: "Lauk Tambahan", value: "• Ikan Super (1 Orang) mulai dari Rp25.000<br>• Ikan Super (2 Orang) mulai dari Rp30.000" }, { label: "Catatan", value: "Harga dapat berubah sewaktu-waktu tanpa pemberitahuan." } ] }, contact: { whatsapp: "6283826231962", phone: "+6283826231962" } }
    ];

        document.addEventListener('DOMContentLoaded', () => {
            const { jsPDF } = window.jspdf;
            
            function formatPrice(amount) {
                return new Intl.NumberFormat('id-ID', {
                    style: 'currency',
                    currency: 'IDR',
                    minimumFractionDigits: 0
                }).format(amount);
            }

            // --- [BARU] FUNGSI BANTUAN UNTUK MEWARNAI KODE QR ---
            async function colorizeQrCode(qrDataUrl, newColor = {r: 0, g: 123, b: 255}) {
                return new Promise((resolve, reject) => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d', { willReadFrequently: true });
                    const img = new Image();
                    img.onload = () => {
                        canvas.width = img.width;
                        canvas.height = img.height;
                        ctx.drawImage(img, 0, 0);
                        try {
                            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                            const data = imageData.data;
                            for (let i = 0; i < data.length; i += 4) {
                                // Jika piksel berwarna hitam (atau mendekati hitam) dan tidak transparan
                                if (data[i] < 50 && data[i+1] < 50 && data[i+2] < 50 && data[i+3] > 200) {
                                    data[i] = newColor.r;     // merah
                                    data[i+1] = newColor.g; // hijau
                                    data[i+2] = newColor.b; // biru
                                }
                            }
                            ctx.putImageData(imageData, 0, 0);
                            resolve(canvas.toDataURL());
                        } catch (error) {
                            console.error("Gagal memproses gambar QR:", error);
                            // Kembali ke gambar asli jika pemrosesan gagal
                            resolve(qrDataUrl);
                        }
                    };
                    img.onerror = (err) => {
                        console.error("Gagal memuat gambar QR:", err);
                        reject(err);
                    };
                    img.crossOrigin = "anonymous";
                    img.src = qrDataUrl;
                });
            }

            // --- [REVISI & PERBAIKAN] FUNGSI GENERATE STRUK DENGAN DESAIN PROFESIONAL ---
            async function generateAndDownloadReceipt(productData, orderDetails) {
                const doc = new jsPDF();
                const transactionId = `TRX-${productData.code}-${Date.now()}`;
                const logoUrl = 'https://raw.githubusercontent.com/LKS-88/anekamarket/refs/heads/main/Logo-Anekamarketku.png';
                
                const toDataURL = url => fetch(url).then(response => response.blob()).then(blob => new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onloadend = () => resolve(reader.result);
                    reader.onerror = reject;
                    reader.readAsDataURL(blob);
                }));

                try {
                    const logoBase64 = await toDataURL(logoUrl);
                    const pageW = doc.internal.pageSize.getWidth();
                    const pageH = doc.internal.pageSize.getHeight();
                    const margin = 15;
                    let y = 0;

                    // --- PALET WARNA ---
                    const brandColor = '#007bff';
                    const darkColor = '#212529';
                    const lightColor = '#f8f9fa';
                    const grayColor = '#6c757d';
                    const borderColor = '#dee2e6';

                    // --- HEADER ---
                    doc.setFillColor(brandColor);
                    doc.rect(0, 0, pageW, 40, 'F');
                    doc.addImage(logoBase64, 'PNG', margin, 7.5, 25, 25);
                    
                    doc.setFontSize(22).setFont(undefined, 'bold');
                    doc.setTextColor('#FFFFFF');
                    doc.text('ANEKAMARKET', pageW - margin, 18, { align: 'right' });
                    doc.setFontSize(9).setFont(undefined, 'normal');
                    doc.text('Jl. PB Sudirman, Wringin Anom, Situbondo', pageW - margin, 24, { align: 'right' });
                    doc.text('admin@anekamarket.my.id', pageW - margin, 29, { align: 'right' });

                    // --- JUDUL DOKUMEN ---
                    y = 55;
                    doc.setFontSize(24).setFont(undefined, 'bold');
                    doc.setTextColor(darkColor);
                    const docTitle = orderDetails.type === 'PRE-ORDER' ? 'BUKTI PRE-ORDER' : 'INVOICE PEMESANAN';
                    doc.text(docTitle, pageW / 2, y, { align: 'center' });
                    
                    // --- INFORMASI TRANSAKSI ---
                    y += 15;
                    doc.setFontSize(10);
                    doc.setTextColor(grayColor);
                    doc.text('DITERBITKAN UNTUK:', margin, y);
                    doc.text('DETAIL TRANSAKSI:', pageW / 2 + 10, y);
                    
                    doc.setDrawColor(borderColor);
                    doc.line(margin, y + 2, pageW - margin, y + 2);

                    y += 8;
                    doc.setFontSize(11).setFont(undefined, 'bold');
                    doc.setTextColor(darkColor);
                    doc.text('Pelanggan Anekamarket', margin, y);
                    
                    const infoLabels = ['ID Transaksi:', 'Tanggal:', 'Gerai Penjual:'];
                    const infoValues = [
                        transactionId,
                        new Date().toLocaleDateString('id-ID', { day: '2-digit', month: 'long', year: 'numeric' }),
                        productData.seller.name
                    ];
                    
                    doc.setFontSize(10).setFont(undefined, 'normal');
                    for (let i = 0; i < infoLabels.length; i++) {
                        doc.setTextColor(grayColor);
                        doc.text(infoLabels[i], pageW / 2 + 10, y + (i * 6));
                        doc.setTextColor(darkColor);
                        doc.text(infoValues[i], pageW - margin, y + (i * 6), { align: 'right' });
                    }
                    
                    // --- TABEL PRODUK ---
                    y += 30;
                    const tableHeaderY = y;
                    doc.setFillColor(darkColor);
                    doc.roundedRect(margin, tableHeaderY, pageW - (margin * 2), 10, 2, 2, 'F');
                    doc.setFontSize(10).setFont(undefined, 'bold');
                    doc.setTextColor('#FFFFFF');
                    doc.text('Deskripsi Produk', margin + 3, tableHeaderY + 7);
                    doc.text('Harga Satuan', pageW - margin - 60, tableHeaderY + 7, { align: 'right' });
                    doc.text('Jumlah', pageW - margin - 35, tableHeaderY + 7, { align: 'right' });
                    doc.text('Subtotal', pageW - margin - 3, tableHeaderY + 7, { align: 'right' });
                    
                    y += 10;
                    doc.setFont(undefined, 'normal').setTextColor(darkColor);
                    doc.setDrawColor(borderColor);

                    orderDetails.items.forEach((item, index) => {
                        const itemY = y;
                        if(index % 2 !== 0){
                            doc.setFillColor(lightColor);
                            doc.rect(margin, itemY, pageW - (margin*2), 10, 'F');
                        }
                        const itemDescription = doc.splitTextToSize(`${item.name} (${productData.code})`, 80);
                        doc.text(itemDescription, margin + 3, itemY + 7);
                        doc.text(formatPrice(item.unitPrice), pageW - margin - 60, itemY + 7, { align: 'right' });
                        doc.text(`${item.quantity} ${orderDetails.unit}`, pageW - margin - 35, itemY + 7, { align: 'right' });
                        doc.text(formatPrice(item.subtotal), pageW - margin - 3, itemY + 7, { align: 'right' });
                        y += 10;
                    });
                    doc.line(margin, y, pageW - margin, y);

                    // --- TOTAL ---
                    y += 5;
                    const totalBoxW = 80;
                    const totalBoxX = pageW - margin - totalBoxW;
                    
                    doc.setFontSize(10);
                    doc.setTextColor(grayColor);
                    doc.text('Total Belanja:', totalBoxX, y + 5, { align: 'right' });
                    doc.setTextColor(darkColor);
                    doc.text(formatPrice(orderDetails.grandTotal), pageW - margin, y + 5, { align: 'right' });
                    
                    if (orderDetails.type === 'PRE-ORDER') {
                        y += 6;
                        doc.setTextColor(grayColor);
                        doc.text('Uang Muka (DP):', totalBoxX, y + 5, { align: 'right' });
                        doc.setTextColor(darkColor);
                        doc.text(orderDetails.dpAmount, pageW - margin, y + 5, { align: 'right' });
                        y += 6;
                        const sisa = orderDetails.grandTotal - parseFloat(orderDetails.dpAmount.replace(/[^0-9]/g, ''));
                        doc.setTextColor(grayColor);
                        doc.text('Sisa Pembayaran:', totalBoxX, y + 5, { align: 'right' });
                        doc.setTextColor(darkColor);
                        doc.text(formatPrice(sisa), pageW - margin, y + 5, { align: 'right' });
                    }
                    
                    y += 8;
                    doc.setLineWidth(0.5);
                    doc.setDrawColor(darkColor);
                    doc.line(totalBoxX - 5, y, pageW - margin, y);
                    
                    y += 2;
                    doc.setFillColor(lightColor);
                    doc.roundedRect(totalBoxX - 5, y, totalBoxW + 5, 12, 2, 2, 'F');
                    
                    doc.setFontSize(12).setFont(undefined, 'bold');
                    const finalAmount = orderDetails.type === 'PRE-ORDER' ? orderDetails.dpAmount : formatPrice(orderDetails.grandTotal);
                    const finalLabel = orderDetails.type === 'PRE-ORDER' ? 'TOTAL DP:' : 'TOTAL BAYAR:';
                    doc.text(finalLabel, totalBoxX, y + 8, { align: 'right' });
                    doc.setTextColor(brandColor);
                    doc.text(finalAmount, pageW - margin, y + 8, { align: 'right' });

                    // --- [PERBAIKAN] FOOTER ---
                    y = pageH - 40;
                    doc.setDrawColor(borderColor);
                    doc.line(margin, y, pageW - margin, y);
                    y += 8;
                    
                    doc.setFontSize(8).setFont(undefined, 'italic').setTextColor(grayColor);
                    const noteText = doc.splitTextToSize('Struk ini merupakan bukti pemesanan yang sah dan dibuat secara otomatis oleh sistem. Harap simpan struk ini untuk proses konfirmasi pembayaran dengan penjual.', pageW - margin * 2 - 30);
                    doc.text(noteText, margin, y);

                    const qr = qrcode(0, 'M');
                    qr.addData('https://s.id/anekamarket');
                    qr.make();
                    const blackQrCodeImage = qr.createDataURL(4);
                    const blueQrCodeImage = await colorizeQrCode(blackQrCodeImage, {r: 0, g: 123, b: 255}); // Mengubah warna QR
                    doc.addImage(blueQrCodeImage, 'PNG', pageW - margin - 22, y, 22, 22);

                    y = pageH - 10; // Posisi y di bagian bawah halaman
                    doc.setFontSize(8).setFont(undefined, 'normal').setTextColor(grayColor);
                    const footerText = `© ${new Date().getFullYear()} ANEKAMARKET | Developed by www.anekamarket.my.id`;
                    doc.text(footerText, pageW / 2, y, { align: 'center' }); // Teks di tengah
                    
                    doc.save(`Struk-${orderDetails.type}-${productData.code}.pdf`);

                } catch (error) {
                    console.error("Gagal membuat PDF:", error);
                    alert("Maaf, terjadi kesalahan saat membuat struk PDF. Silakan coba lagi.");
                }
            }


            // --- FUNGSI RENDER PRODUK (TIDAK BERUBAH) ---
            const galleryGrid = document.getElementById('gallery-grid');
            const body = document.body;
            
            function renderProducts() {
                if (!galleryGrid) return;
                galleryGrid.innerHTML = '';
                
                products.forEach(product => {
                    const productCard = document.createElement('div');
                    productCard.className = 'gallery-item';
                    productCard.setAttribute('data-category', product.category);
                    productCard.setAttribute('data-type', product.type);
                    productCard.setAttribute('data-id', product.id);
                    productCard.id = `product-${product.id}`;

                    const priceVariationsHTML = product.priceVariations.map(v => `
                        <div class="price-variation-item" data-price="${v.price}" data-name="${v.name}">
                            <div class="price-variation-info">
                                <span class="price-variation-name">${v.name}</span>
                                <span class="price-variation-value">${formatPrice(v.price)}</span>
                            </div>
                            <div class="quantity-controls">
                                <button class="quantity-btn minus" aria-label="Kurangi jumlah">-</button>
                                <input type="number" class="quantity-input" value="0" min="0" aria-label="Jumlah item">
                                <button class="quantity-btn plus" aria-label="Tambah jumlah">+</button>
                            </div>
                        </div>
                    `).join('');

                    const unitOptionsHTML = product.units.map(unit => `<option value="${unit}" ${unit === product.defaultUnit ? 'selected' : ''}>${unit}</option>`).join('');
                    const detailImagesHTML = product.details.images.map((img, index) => `<img src="${img}" alt="Thumbnail ${index + 1}" class="thumbnail" loading="lazy">`).join('');
                    const detailSpecsHTML = product.details.specs.map(spec => `<div class="spec-item"><span class="spec-label">${spec.label}:</span><span class="spec-value">${spec.value}</span></div>`).join('');
                    
                    productCard.innerHTML = `
                        <a href="${product.seller.link}" target="_blank" class="gallery-badge seller">Gerai: ${product.seller.name}</a>
                        <span class="gallery-badge ${product.badge.type}">${product.badge.text}</span>
                        <div class="gallery-image-container"><img src="${product.mainImage}" alt="${product.title}" class="gallery-image" loading="lazy"></div>
                        <div class="gallery-details">
                            <h3 class="gallery-title">${product.title}</h3>
                            <div class="gallery-meta"><span class="gallery-code">Kode: ${product.code}</span><span class="gallery-seller"><i class="fas fa-store"></i> ${product.seller.name}</span></div>
                            <p class="gallery-price">
                                Mulai dari ${formatPrice(product.price)}
                                ${product.originalPrice ? `<span class="original-price">${formatPrice(product.originalPrice)}</span>` : ''}
                                ${product.discount ? `<span class="discount">${product.discount}</span>` : ''}
                            </p>
                            
                            <div class="price-variations-container">${priceVariationsHTML}</div>
                             <select class="unit-select" style="width:100%; margin-top:10px; padding: 8px;">${unitOptionsHTML}</select>
                            
                            <div class="total-price">
                                <span class="total-price-label">Total Harga:</span>
                                <span class="total-price-value">${formatPrice(0)}</span>
                            </div>
                            
                            <div class="gallery-actions">
                                <button class="btn-detail"><i class="fas fa-chevron-down"></i> Detail</button>
                                <a href="${product.seller.link}" target="_blank" class="btn-visit"><i class="fas fa-store-alt"></i> Kunjungi Gerai</a>
                                <button class="btn-order"><i class="fas fa-shopping-cart"></i> Pesan</button>
                                <button class="btn-preorder-toggle"><i class="fas fa-calendar-check"></i> Pre-Order</button>
                            </div>
                            
                            <div class="preorder-form">
                                <div class="preorder-title"><i class="fas fa-money-bill-wave"></i><span>Form Uang Muka (DP)</span></div>
                                <input type="number" class="preorder-input" placeholder="Masukkan nominal DP (minimal 40%)">
                                <p class="preorder-note">* Untuk pre-order, harap masukkan nominal uang muka minimal 40% dari total harga. Kami akan menghubungi Anda untuk konfirmasi lebih lanjut.</p>
                                <button class="btn-preorder"><i class="fas fa-paper-plane"></i> Kirim Pre-Order</button>
                            </div>
                            
                            <div class="gallery-detail-expanded">
                                <div class="gallery-carousel"><img src="${product.mainImage}" alt="${product.title}" class="gallery-main-image" loading="lazy"><div class="gallery-thumbnails">${detailImagesHTML}</div></div>
                                <div class="gallery-content"><p class="gallery-description">${product.details.description}</p><div class="gallery-specs">${detailSpecsHTML}</div></div>
                                <div class="gallery-actions-expanded"><a href="https://wa.me/${product.contact.whatsapp}?text=Halo%20${encodeURIComponent(product.seller.name)},%20saya%20tertarik%20dengan%20produk%20${encodeURIComponent(product.title)}%20(${product.code})" class="btn-whatsapp" target="_blank"><i class="fab fa-whatsapp"></i> Chat via WhatsApp</a><a href="tel:${product.contact.phone}" class="btn-call"><i class="fas fa-phone-alt"></i> Telepon Sekarang</a></div>
                            </div>
                        </div>
                    `;
                    galleryGrid.appendChild(productCard);
                });
            }

            renderProducts();

            // --- SCRIPT LOGIKA PEMBELIAN (TIDAK BERUBAH) ---
            if (galleryGrid) {
                const updateGrandTotal = (productCard) => {
                    let grandTotal = 0;
                    const variationItems = productCard.querySelectorAll('.price-variation-item');
                    
                    variationItems.forEach(item => {
                        const price = parseFloat(item.dataset.price) || 0;
                        const quantityInput = item.querySelector('.quantity-input');
                        const quantity = parseInt(quantityInput.value, 10) || 0;
                        grandTotal += price * quantity;
                    });
                    
                    const totalPriceElement = productCard.querySelector('.total-price-value');
                    if (totalPriceElement) {
                        totalPriceElement.textContent = formatPrice(grandTotal);
                    }
                };

                galleryGrid.addEventListener('click', e => {
                    const target = e.target;
                    if (target.classList.contains('quantity-btn')) {
                        const btn = target;
                        const input = btn.parentElement.querySelector('.quantity-input');
                        let value = parseInt(input.value, 10) || 0;

                        if (btn.classList.contains('plus')) {
                            value++;
                        } else if (btn.classList.contains('minus') && value > 0) {
                            value--;
                        }
                        input.value = value;
                        
                        const productCard = target.closest('.gallery-item');
                        if(productCard) updateGrandTotal(productCard);
                        playButtonSound();
                    }
                });
                
                galleryGrid.addEventListener('input', e => {
                    const target = e.target;
                    if (target.classList.contains('quantity-input')) {
                        if (target.value < 0) target.value = 0;
                        const productCard = target.closest('.gallery-item');
                        if(productCard) updateGrandTotal(productCard);
                    }
                });

                galleryGrid.addEventListener('click', e => {
                    const target = e.target;
                    const detailsContainer = target.closest('.gallery-details');
                    if (!detailsContainer) return;

                    if (target.closest('.btn-detail')) { const btn = target.closest('.btn-detail'); const expandedContent = btn.closest('.gallery-details').querySelector('.gallery-detail-expanded'); expandedContent.classList.toggle('active'); btn.classList.toggle('active'); btn.innerHTML = expandedContent.classList.contains('active') ? '<i class="fas fa-chevron-up"></i> Sembunyikan Detail' : '<i class="fas fa-chevron-down"></i> Detail Produk'; if (expandedContent.classList.contains('active')) expandedContent.scrollIntoView({ behavior: 'smooth', block: 'nearest' }); playButtonSound(); }
                    if (target.classList.contains('thumbnail')) { const mainImage = target.closest('.gallery-carousel').querySelector('.gallery-main-image'); mainImage.src = target.src; target.parentElement.querySelectorAll('.thumbnail').forEach(t => t.classList.remove('active')); target.classList.add('active'); playButtonSound(); }
                    if(target.classList.contains('gallery-main-image')) { document.getElementById('zoomedImage').src = target.src; document.getElementById('imageModal').classList.add('show'); body.style.overflow = 'hidden'; playButtonSound(); }
                    if (target.closest('.btn-preorder-toggle')) { const btn = target.closest('.btn-preorder-toggle'); const preorderForm = detailsContainer.querySelector('.preorder-form'); preorderForm.classList.toggle('active'); btn.classList.toggle('active'); btn.innerHTML = preorderForm.classList.contains('active') ? '<i class="fas fa-times"></i> Batal Pre-Order' : '<i class="fas fa-calendar-check"></i> Pre-Order'; playButtonSound(); }

                    const galleryItem = target.closest('.gallery-item');
                    if (!galleryItem) return;
                    const productId = galleryItem.dataset.id;
                    const productData = products.find(p => p.id === productId);

                    const gatherOrderDetails = (type = 'PEMESANAN LANGSUNG') => {
                        const items = [];
                        let grandTotal = 0;
                        const unit = detailsContainer.querySelector('.unit-select').value;
                        const variationItems = detailsContainer.querySelectorAll('.price-variation-item');
                        
                        variationItems.forEach(item => {
                            const quantity = parseInt(item.querySelector('.quantity-input').value, 10) || 0;
                            if (quantity > 0) {
                                const name = item.dataset.name;
                                const unitPrice = parseFloat(item.dataset.price);
                                const subtotal = unitPrice * quantity;
                                items.push({ name, quantity, unitPrice, subtotal });
                                grandTotal += subtotal;
                            }
                        });

                        if (items.length === 0) {
                            alert('Anda belum memilih item atau jumlah produk.');
                            return null;
                        }
                        
                        let dpAmount = 'N/A';
                        if (type === 'PRE-ORDER') { 
                            const dpInput = detailsContainer.querySelector('.preorder-input'); 
                            const dpValue = parseFloat(dpInput.value); 
                            if (isNaN(dpValue) || dpValue <= 0) { alert('Mohon masukkan nominal DP yang valid'); return null; } 
                            if (dpValue < (grandTotal * 0.4)) { alert(`Uang muka minimal 40% dari total harga (${formatPrice(grandTotal * 0.4)})`); return null; } 
                            dpAmount = formatPrice(dpValue); 
                        }

                        return { type, items, grandTotal, unit, dpAmount };
                    };
                    
                    const generateWhatsAppMessage = (product, details) => {
                        let itemsText = details.items.map(item => `   - ${item.name} (x${item.quantity})`).join('\n');
                        let totalText = `Total Harga: *${formatPrice(details.grandTotal)}*`;
                        if(details.type === 'PRE-ORDER') {
                            totalText += `\nUang Muka: *${details.dpAmount}*`;
                        }
                        return `Halo, saya ingin memesan produk dari *${product.seller.name}*:\n\n*${product.title}*\n${itemsText}\n\nSatuan: ${details.unit}\n${totalText}\n\nStruk pemesanan sudah saya unduh. Mohon info lebih lanjut. Terima kasih.`;
                    }

                    if (target.closest('.btn-order')) {
                        const orderDetails = gatherOrderDetails('PEMESANAN LANGSUNG');
                        if (orderDetails) {
                            const confirmation = confirm(`Anda akan memesan dengan total ${formatPrice(orderDetails.grandTotal)}.\n\nLanjutkan?`);
                            if (confirmation) {
                                generateAndDownloadReceipt(productData, orderDetails);
                                const message = generateWhatsAppMessage(productData, orderDetails);
                                window.open(`https://wa.me/${productData.contact.whatsapp}?text=${encodeURIComponent(message)}`, '_blank');
                                playButtonSound();
                            }
                        }
                    }
                    
                    if (target.closest('.btn-preorder')) {
                        const orderDetails = gatherOrderDetails('PRE-ORDER');
                        if (orderDetails) {
                            const confirmation = confirm(`Anda akan Pre-Order dengan total ${formatPrice(orderDetails.grandTotal)} dan DP ${orderDetails.dpAmount}.\n\nLanjutkan?`);
                            if(confirmation){
                                generateAndDownloadReceipt(productData, orderDetails);
                                const message = generateWhatsAppMessage(productData, orderDetails);
                                window.open(`https://wa.me/${productData.contact.whatsapp}?text=${encodeURIComponent(message)}`, '_blank');
                                playButtonSound();
                            }
                        }
                    }
                });
            }

            // --- FITUR PENCARIAN & SKRIP LAINNYA (TIDAK BERUBAH) ---
            const searchModal = document.getElementById('searchModal'); const searchModalInput = document.getElementById('searchModalInput'); const searchResults = document.getElementById('searchResults'); const headerSearchInput = document.getElementById('headerSearchInput'); const headerSearchBtn = document.getElementById('headerSearchBtn'); const navSearchInput = document.getElementById('navSearchInput'); const navSearchBtn = document.getElementById('navSearchBtn');
            function openSearchModal(query = '') { searchModal.classList.add('show'); body.style.overflow = 'hidden'; searchModalInput.value = query; searchModalInput.focus(); performSearch(query); }
            function closeSearchModal() { searchModal.classList.remove('show'); body.style.overflow = ''; }
            function performSearch(query) { const lowerCaseQuery = query.trim().toLowerCase(); if (lowerCaseQuery.length < 2) { searchResults.innerHTML = '<p class="search-results-placeholder">Ketik minimal 2 huruf...</p>'; return; } const results = products.filter(p => [p.title, p.seller.name, p.code, p.details.description.replace(/<[^>]*>?/gm, ''), ...p.details.specs.map(s => `${s.label} ${s.value.replace(/<[^>]*>?/gm, '')}`)].join(' ').toLowerCase().includes(lowerCaseQuery)); displaySearchResults(results); }
            function displaySearchResults(results) { if (results.length === 0) { searchResults.innerHTML = '<p class="search-results-placeholder">Produk tidak ditemukan.</p>'; return; } searchResults.innerHTML = results.map(p => `<a href="#product-${p.id}" class="search-result-item" data-product-id="${p.id}"><img src="${p.mainImage}" alt="${p.title}" class="search-result-image"><div class="search-result-info"><h4>${p.title}</h4><p>oleh ${p.seller.name} (Kode: ${p.code})</p></div></a>`).join(''); }
            [headerSearchInput, navSearchInput].forEach(input => { input.addEventListener('keypress', (e) => { if (e.key === 'Enter') { e.preventDefault(); openSearchModal(input.value); } }); });
            [headerSearchBtn, navSearchBtn].forEach(button => { button.addEventListener('click', (e) => { e.preventDefault(); const input = button.previousElementSibling; openSearchModal(input.value); }); });
            searchModalInput.addEventListener('input', () => { performSearch(searchModalInput.value); });
            searchResults.addEventListener('click', (e) => { const link = e.target.closest('.search-result-item'); if (link) { e.preventDefault(); const targetId = link.getAttribute('href'); const targetElement = document.querySelector(targetId); if (targetElement) { closeSearchModal(); setTimeout(() => { window.scrollTo({ top: targetElement.offsetTop - 100, behavior: 'smooth' }); }, 100); } } });
            const bgMusic = document.getElementById('bgMusic'); if (bgMusic) { bgMusic.volume = 0.3; let p = false; const pm = () => { if (!p) { bgMusic.play().then(() => { p = true; }).catch(() => {}); } }; pm(); document.body.addEventListener('click', pm, { once: true }); document.body.addEventListener('touchstart', pm, { once: true }); }
            const particlesContainer = document.getElementById('particles'); if (particlesContainer) { for (let i = 0; i < 40; i++) { const pr = document.createElement('div'); pr.classList.add('particle'); const s = Math.random() * 6 + 2; pr.style.width = `${s}px`; pr.style.height = `${s}px`; pr.style.left = `${Math.random() * 100}%`; pr.style.animationDuration = `${Math.random() * 15 + 15}s`; pr.style.animationDelay = `${Math.random() * 10}s`; particlesContainer.appendChild(pr); } }
            const navbar = document.getElementById('navbar'); window.addEventListener('scroll', () => { if (navbar) { navbar.classList.toggle('scrolled', window.scrollY > 50); } });
            const mobileMenuToggle = document.getElementById('mobileMenuToggle'); const navLinks = document.getElementById('navLinks'); if (mobileMenuToggle && navLinks) { mobileMenuToggle.addEventListener('click', () => { navLinks.classList.toggle('active'); mobileMenuToggle.innerHTML = navLinks.classList.contains('active') ? '<i class="fas fa-times"></i>' : '<i class="fas fa-bars"></i>'; playButtonSound(); }); navLinks.addEventListener('click', (e) => { if (e.target.tagName === 'A') { navLinks.classList.remove('active'); mobileMenuToggle.innerHTML = '<i class="fas fa-bars"></i>'; } }); }
            const searchToggle = document.getElementById('searchToggle'); const navSearch = document.getElementById('navSearch'); if(searchToggle && navSearch) { searchToggle.addEventListener('click', () => { navSearch.classList.toggle('active'); playButtonSound(); }); }
            const productCategories = document.querySelector('.product-categories'); const categoryTabs = document.querySelector('.category-tabs'); let activeCategory = 'all'; let activeType = 'all';
            function applyFilters() { document.querySelectorAll('.gallery-item').forEach(item => { const iC = item.dataset.category; const iT = item.dataset.type; const cM = activeCategory === 'all' || iC === activeCategory; const tM = activeType === 'all' || iT === activeType; item.style.display = (cM && tM) ? 'block' : 'none'; }); }
            if (productCategories) { productCategories.addEventListener('click', e => { if (e.target.classList.contains('product-category-btn')) { productCategories.querySelectorAll('.product-category-btn').forEach(btn => btn.classList.remove('active')); e.target.classList.add('active'); activeCategory = e.target.dataset.category; applyFilters(); playButtonSound(); } }); }
            if (categoryTabs) { categoryTabs.addEventListener('click', e => { if (e.target.classList.contains('category-btn')) { categoryTabs.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active')); e.target.classList.add('active'); activeType = e.target.dataset.type; applyFilters(); playButtonSound(); } }); }
            const contactForm = document.getElementById('contactForm'); if (contactForm) { contactForm.addEventListener('submit', function(e) { e.preventDefault(); alert('Fitur ini sedang dalam pengembangan.'); playButtonSound(); }); }
            const orderModal = document.getElementById('orderModal'); const quickOrderBtn = document.getElementById('quick-order'); if (orderModal && quickOrderBtn) { quickOrderBtn.addEventListener('click', () => { orderModal.classList.add('show'); body.style.overflow = 'hidden'; playButtonSound(); }); }
            document.querySelectorAll('.modal, .image-modal, .search-modal').forEach(modal => { modal.addEventListener('click', (e) => { if (e.target === modal || e.target.classList.contains('close-modal') || e.target.classList.contains('close-image-modal') || e.target.classList.contains('close-search-modal')) { modal.classList.remove('show'); body.style.overflow = ''; } }); });
            const buttonSound = document.getElementById('buttonSound'); function playButtonSound() { if(buttonSound) { buttonSound.currentTime = 0; buttonSound.play().catch(() => {}); } }
            document.querySelectorAll('a[href^="#"]').forEach(anchor => { anchor.addEventListener('click', function(e) { if (this.getAttribute('href') !== '#' && !this.closest('.search-result-item')) { e.preventDefault(); const target = document.querySelector(this.getAttribute('href')); if (target) { window.scrollTo({ top: target.offsetTop - 80, behavior: 'smooth' }); } } }); });
            const offerNotification = document.getElementById('offerNotification'); const step1 = document.getElementById('notificationStep1'); const step2 = document.getElementById('notificationStep2'); const showNotification = () => { if (!sessionStorage.getItem('offerDismissed')) { offerNotification.classList.add('show'); } }; const hideNotification = () => { offerNotification.classList.remove('show'); sessionStorage.setItem('offerDismissed', 'true'); }; setTimeout(showNotification, 5000); offerNotification.addEventListener('click', (e) => { const t = e.target; if (t.id === 'closeNotification') hideNotification(); if (t.matches('.notification-btn')) { const a = t.dataset.action; if (a === 'close') hideNotification(); else if (a === 'next') { step1.classList.remove('active'); step2.classList.add('active'); } else if (a === 'register') { window.open('https://anekamarket.github.io/formulir/', '_blank'); hideNotification(); } } });
        });
    </script>
</body>
</html>
